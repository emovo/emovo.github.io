<!DOCTYPE html>
<html lang="en" dir="ltr">
    <title>EMOVO</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<body class="w3-light-grey">
  <div class="w3-bar w3-light-grey w3-card w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-padding-large w3-hover-white w3-large w3-orange" href="javascript:void(0);" onclick="toggle()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>
    <a href="index.html" class="w3-bar-item w3-button w3-text-orange w3-hide-small w3-padding-large w3-hover-orange"><b><img src="emovo.png" width="25px" height="25px" alt="EMOVO"></img></b></a>
    <a href="about.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-orange">About</a>
    <a href="contact.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-orange">Contact</a>
    <a href="search.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-orange">Search</a>
    <!--<a href="profile.html" class="w3-bar-item w3-button w3-right w3-hide-small w3-padding-large w3-hover-orange w3-text-grey"><i class="fa fa-user"></i>  Your Profile</b></a>-->
  </div>
     <!--<div>
       <button onclick="home()" class="w3-bar-item w3-button w3-text-orange w3-hide-small w3-padding-large w3-hover-orange"><b><img src="emovo.png" width="25px" height="25px" alt="EMOVO"></img></b></button>
       <button onclick="about()" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-orange">About</button>
       <button onclick="contact()" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-orange">Contact</button>
       <button onclick="search()" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-orange">Search</button>
    </div>-->
      <div class="w3-orange">
        <img id="flaglink" src="#" width="200px"><!--have it to the left with basic facts about area-->
        <h3 id="sname">State name (Capital: )</h3>
        <h4 id="capital">Capital</h4>
        <p id="avgStar"></p>
        <p id="languages"></p>
        <p id="currency"></p>
        <p id="population">
        <p id="summary">
          <!--<br>
          Strong Points:
          <br>
          Average Qualities:
          <br>
          Weaker Points:
          <br>-->
          The data was compiled from numerous sources as explained <a href="about.html">here</a>. If you find any major errors, please send me an email through <a href="contact.html">here</a>.
          Post in the comments to provide a helpful view of this country to others! Conversely, be sure to look in the comments for more specific details from those who lived there. To find the best cities in the country, click the "Optimized City Search" button, or if you wish to re-enter data click the "Input New Data" button below.
        </p></p>
      </div>
      <div style="display:table; margin:0 auto;">
             <button onclick="onCitySearchClick()" style="float: left;border: 2px solid #E8E8E8;" class="w3-button w3-orange">Optimized City Search</button>
             <button onclick="input.html" style="float: right;border: 2px solid #E8E8E8;" class="w3-button w3-orange">Input New Data</button>
      </div>
      <br>
      <!--<div class="right-text">
        <h4>Notes</h4>

      </div>-->
      <div class="right-data">
        <div class="right-right-data">
        <table class="tableData" style="margin:auto;">
              <div class="econ">
                <h5 style="margin:0 auto;text-align:center; background-color:green; color:white;">Economic Data  <i class="fa fa-dollar"></i></h5>
                <!--<h6 id="econSortRank" style="text-align:center; color:green;">80th percentile (#5)</h6>-->
                    <tr>
                      <td>Country Data</td>
                      <td></td>
                      <td>Your Data</td>
                    </tr>
                    <tr>
                      <td>Avg Income</td>
                      <td id="avgIncome">$10000
                        <td id="avgIncomeDiff" style="color:green;">
                          <div class="tooltip">
                            <span id="avgIncomeDiffVal" style="border-bottom: 1px dotted #000;text-decoration: none;">$10000</span>
                            <span id="tooltiptextavgIncome" class="tooltiptext">Better than avg.</span>
                          </div>
                      </td>
                     </td>
                    </tr>
                    <tr>
                      <td>Approx. Property Rent Cost: </td>
                      <td id="median">$10000</td>
                      <!--<td id="medianDiff" style="color:green;">
                          <div class="tooltip">
                            <span id="medianDiffVal" style="border-bottom: 1px dotted #000;text-decoration: none;">$10000</span>
                            <span id="tooltiptextmedianDiff" class="tooltiptext">Better than avg.
                            </span>
                          </div>
                      </td>-->
                    </tr>
                    <!--<tr>
                      <td>Healthcare Cost: </td>
                      <td id="healthCareCost">$10000</td>
                    </tr>
                    <tr>
                      <td>Unemployment Rate: </td>
                      <td id="unemploymentRate">10%</td>
                    </tr>-->
                    <tr>
                      <td>Income Tax (Upper range): </td>
                      <td id="higherIncomeTax">10%</td>
                    </tr>
                    <tr>
                      <td>Income Tax (Lower range): </td>
                      <td id="lowerIncomeTax">10%</td>
                    </tr>
                    <tr>
                      <td>Sales Tax: </td>
                      <td id="salesTax">10%</td>
                    </tr>
                </div>
            </table>
            <br>
            <table style="margin:0 auto;">
              <div class="ppliticsTable">
                  <table class="tableData" style="margin:0 auto;">
                    <h5 style="margin:0 auto;text-align:center;background:blue;color:white;">Sociopolitical Data <i class="fa fa-gavel"></i></h5>
                    <!--<h6 id="politicsRank" style="text-align:center; color:green;">80th percentile (#5)</h6>-->
                    <tr>
                      <td>Country Data</td>
                    </tr>
                    <tr>
                      <td>Crime Rate: </td>
                      <td id="crimeRate"></td>
                    </tr>
                    <tr>
                      <td>Freedom Index (Freedom House): </td>
                      <td id="freedomIndex"></td>
                    </tr>
                  </table>
              </div>
            </table>
            <br>
            <br>
            <table style="margin:0 auto;">
              <div class="chealth">
                  <table class="tableData" style="margin:0 auto;">
                    <h5 style="margin:0 auto;text-align:center; background:red;color:white;width:56.5%;">Health Data <i class="fa fa-hospital-o"></i></h5>
                    <!--<h6 id="healthRank" style="text-align:center; color:green;">80th percentile (#5)</h6>-->
                    <tr>
                      <td>Country Data</td>
                    </tr>
                    <tr>
                      <td>Human Development Index (United Nations): </td>
                      <td id="hdiValue"></td>
                    </tr>
                    <tr>
                      <td>Average Life Expectancy: </td>
                      <td id="ageExp"></td>
                    </tr>
                  </table>
              </div>
            </table>
            <br>
            <table style="margin:0 auto;">
              <div class="env">
                  <table class="tableData" style="margin:0 auto;">
                    <h5 style="margin:0 auto;text-align:center;background:#00FF00;width:56.5%">Environment Data <i class="fa fa-industry"></i></h5>
                    <tr style="text-align:center;">
                      <td>Country Data</td>
                    </tr>
                    <tr>
                      <td>Average Annual Temperature: </td>
                      <td id="temp"></td>
                      <td id="tempDiff" style="text-align:left; color:green;">
                        <div class="tooltip">
                          <span id="tempDiffVal"></span>
                          <span id="tooltiptexttempDiff" class="tooltiptext">
                          </span>
                        </div>
                      </td>
                    </tr>
                  </table>
              </div>
            </table>
      </div>
      <br>
      <div style="display:table; margin: auto;">
        <p>Featured Location Video (randomly selected)</p>
        <iframe id="video" width="400" height="300" src="#">
        </iframe>
      </div>
     <br>
     <p id="login" style="display:table; margin: 0 auto;"></p>
     <br>
     <div class="userReply">
       <p style="margin: auto;">How would you rate the place in terms of livability, especially in regards to retirees (1-5 stars)? Explain in the comment box below if you wish to futher elaborate to inform other users.</p>
       <p></p>
           <form id="starsRating" style="display: inline-block;">
             <input class="star star-5" id="star-5" type="radio" name="star" value="5"/>
             <label class="star star-5" for="star-5"></label>
             <input class="star star-4" id="star-4" type="radio" name="star" value="4"/>
             <label class="star star-4" for="star-4"></label>
             <input class="star star-3" id="star-3" type="radio" name="star" value="3"/>
             <label class="star star-3" for="star-3"></label>
             <input class="star star-2" id="star-2" type="radio" name="star" value="2"/>
             <label class="star star-2" for="star-2"></label>
             <input class="star star-1" id="star-1" type="radio" name="star" value="1"/>
             <label class="star star-1" for="star-1"></label>
           </form>
           <div class="container">
             <div class="left-pic">
               <img id="profileImg" src="https://cdn2.iconfinder.com/data/icons/website-icons/512/User_Avatar-512.png" width="70px" height="70px" style="border-radius: 50%;">
             </div>
            <div class="right">
                  <textarea id="yourComment" name="name" rows="4" cols="40" placeholder="Enter comment here"></textarea>
             </div>
           </div>
           <p></p>
           <div>
             <button class="w3-button w3-orange" type="submit" onclick="sendMessage()">Send rating and/or review</button>
           </div>
     </div>
    </div>
    <div id="justSents">
    </div>
    <div style="margin-left:-8px;margin-right:-8px"><hr style="color:Black;background-color:Black;border:0;width:100%;height:1px;" /></div>
    <div id="commentSpace">
      <div class="container" style="margin:0 auto">
        <!--<div>
          <input type="text" id="input" onkeyup="filter()" placeholder="Search" title="Type keywords">
        </div>-->
        <div>
          <select id="commentFilter" onchange="filter()">
            <option value="Newest" selected="selected">Keywords</option>
            <option value="likes">Likes</option>
            <!--<option value="commenter">Commenter</option>
            <option value="replies">Replies to you</option>-->
          </select>
        </div>
     </div>
   </div>
   <div id="updownSort">

   </div>
</body>
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif}
.w3-bar,h1,button {font-family: "Montserrat", sans-serif}
body, html {
	height: 100%;
	width: 100%;
}
.tooltip {
  position: relative;
  display: inline-block;
  top: 100%;
}
.tooltip .tooltiptext{
  visibility: hidden;
  width: 120px;
  background-color: black;
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 5px 0;

  /* Position the tooltip
    z-index: 1;
    bottom: 100%;
    left: 10%;*/
}
.tooltip:hover .tooltiptext {
  visibility: visible;
}
.left-data{
  display: inline-block;
  background-color:orange;
  color:white;
  position: absolute;
  height:150%;
  width:15%;
  /*top: 0;*/
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}
.right-right-data{
  display: inline-block;
}
.right-data{
  width: 100%;
  text-align: center;
  /*display:table;
  margin: 0 auto;
  vertical-align: middle;*/
  /*position: absolute;
  text-align: center;
  right: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;*/
}
.right-text{
  display: inline-block;
  background-color:orange;
  color:white;
  position: absolute;
  height:100%;
  width:15%;
  right: 0;
  text-align: center;
  overflow: hidden;
}
.fourTable, td {
border: 1px solid black;
}
/*.top-boxes{
  display:table;
  margin: 0 auto;
}
.econ{
  width:10%;
  border: 15px solid green;
}
.phealth{
  width:10%;
  border: 15px solid green;
}

.bottom-boxes{
  display:table;
  margin: 0 auto;
}
.chealth{
  width:10%;
  border: 15px solid green;
}
.env{
  width:10%;
  border: 15px solid green;
}*/
.loadMore{
  display: table;
  margin: 0 auto;
}
.userReply{
  width: 36%;
  display: table;
  margin: 0 auto;
  text-align: center;
}
.container{
  width:500px;
  min-height:65px;
}
.left-pic{
  float: left;
  width:50px;
}
.right{
  float: right;
  width:400px;
}
.comment-body {
  display: inline-block;
  vertical-align: middle;
  width: 400px;
  min-height: 65px;
  color: #555;
  background-color: white;
}
input.star { display: none; }
label.star {
	  float: right;
    margin:0 auto;
	  padding: 10px;
	  font-size: 36px;
	  color: #444;
	  transition: all .2s;
	}
input.star:checked ~ label.star:before {
	  content: '\f005';
	  color: #FD4;
	  transition: all .25s;
	}
	input.star-5:checked ~ label.star:before {
	  color: #FE7;
	  text-shadow: 0 0 20px #952;
	}
	input.star-1:checked ~ label.star:before { color: #F62; }
	label.star:before {
	  content: '\f006';
	  font-family: FontAwesome;
	}
  .tableData {
  border-collapse: collapse;
  width: 75%;
}

.tableData td, .tableData th {
  border: 1px solid #ddd;
  padding: 8px;
}

.tableData tr:nth-child(even){background-color: #f2f2f2;}

.tableData tr:hover {background-color: #ddd;}

.tableData th {
  padding-top: 12px;
  padding-bottom: 12px;
  text-align: left;
  background-color: #4CAF50;
  color: white;
}
</style>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.1.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.1.0/firebase-database.js"></script>
<script type="text/javascript">
/*function home(){
  leave()
  window.location.replace("index.html")
}
function about(){
  leave()
  window.location.replace("about.html")
}
function contact(){
  leave()
  window.location.replace("contact.html")
}
function search(){
  leave()
  window.location.replace("search.html")
}*/
/*function profile(){
  leave()
  window.location.replace("profile.html")
}*/
function Currency(name, code, symbol, income, savings) {
    this.name=name
    this.code=code
    this.symbol=symbol
    this.convertedIncome=income
    this.convertedSavings=savings
}
function Language(name, localname) {
    this.name=name
    this.localName=localname
}
function USTaxRates(prop, income, sales) {
  this.propertyTax=prop
  this.incomeTax=income
  this.salesTax=sales
}
function TaxRates(high, low, sales) {
  this.highIncomeTax=high
  this.lowIncomeTax=low
  this.salesTax=sales
}
function Temperature(ftemp, ctemp, category) {
  this.fTemp=ftemp
  this.cTemp=ctemp
  this.category=category
}
function Country(name, capitalcity, gini, gni, taxrates, housingcost, currencyList, crimerate, languageList, alpha2, alpha3, population, area, lat, lng, flaglink, incomelevel, incomeDiff, temp, freedom, hdi, age, rankAvg, cities, citiesData, match, comments,tempDiff,housingDiff){
  this.name=name
  this.capitalCity=capitalcity
  this.gini=gini
  this.gni=gni
  this.taxRates=taxrates
  this.housingCost=housingcost
  this.currencyList=currencyList
  this.crimeRate=crimerate
  this.languageList=languageList
  this.alpha2=alpha2
  this.alpha3=alpha3
  this.population=population
  this.area=area //in billion meters squared
  this.lat=lat
  this.lng=lng
  this.flaglink=flaglink
  this.incomeLevel=incomelevel
  this.incomeDiff=incomeDiff
  this.temp=temp
  this.freedomIndex=freedom
  this.hdiValue=hdi
  this.ageExp=age
  this.rankAvg=rankAvg
  this.cities=cities
  this.citiesData=citiesData
  this.percentMatch=match
  this.tempDiff=tempDiff
  this.housingDiff=housingDiff
}
//document.getElementById("myModal").style="display:none;"
var country=JSON.parse(localStorage.getItem("nation"))
document.getElementById("video").src="https://www.youtube.com/embed/?listType=search&list="+country.name.replace(" "+"-")+"-country&autoplay=1"
//document.getElementById("video").src="https://www.youtube.com/embed/?listType=search&list=living-in-"+country.name.replace(" "+"-")+"&autoplay=1"
//console.log(country)
document.getElementById("starsRating").reset()
document.getElementById("flaglink").src=country.flaglink
document.getElementById("sname").innerHTML=country.name
document.getElementById("capital").innerHTML="Capital: "+country.capitalCity
var lans=""
for(var a in country.languageList)
  if(a>1)
    lans+=", "
  lans=lans+country.languageList[a].name+" ("+country.languageList[a].localName+")"
document.getElementById("languages").innerHTML="Official Languages: "+lans
var currs=""
for(var a in country.currencyList)
  if(a>1)
    currs+=", "
  currs=currs+country.currencyList[a].name+" ("+country.currencyList[a].symbol+", "+country.currencyList[a].code+")"
document.getElementById("currency").innerHTML="Official Currencies: "+currs //could get conversion in the future
document.getElementById("population").innerHTML="Population: "+country.population
//economic data
document.getElementById("avgIncome").innerHTML="$"+parseFloat(country.gni).toFixed(2)
document.getElementById("avgIncomeDiffVal").innerHTML="$"+(localStorage.monthlyIncomeWorld*12.0).toFixed(2)
var avgIncomeDiffStyle="border: none; color:green;"
var text=""
var fract=country.gni/(localStorage.monthlyIncomeWorld*12.0)
if(fract<.25){
  text="Looking at income alone, your economic status is very above average"
  avgIncomeDiffStyle="border: none; color:green;"
}
else if(fract>=1.75){
  text="Looking at income alone, your economic status is very below average"
  avgIncomeDiffStyle="border: none; color:red;"
}
else if(fract>.75 && fract<1.25){
  text="Looking at income alone, your economic status is around average"
  avgIncomeDiffStyle="border: none; color:orange;"
}
else if(fract<=.75){
  text="Looking at income alone, your economic status is above average"
  avgIncomeDiffStyle="border: none; color:green;"
}
else if(fract>=1.25){
  text="Looking at income alone, your economic status is below average"
  avgIncomeDiffStyle="border: none; color:red;"
}
document.getElementById("tooltiptextavgIncome").innerHTML=text
document.getElementById("avgIncomeDiff").style=avgIncomeDiffStyle
//country.housingCost=housingList[country.name]*31.0
var housingList={"Monaco":305.83,"Angola":125.78,"Papua New Guinea":117.22,"Bermuda":109.01,"Singapore":97.81,"Macao":87.38,"Hong Kong":87.38,"Guernsey":84.57,"Qatar":77.25,"Gibraltar":70.16,"Jersey":69.49,"Luxembourg":67.03,"British Virgin Islands":66.25,"Switzerland":66.24,"United Arab Emirates":65.56,"Norway":62.73,"Liberia":61.99,"Isle of Man":59.52,"Australia":58.91,"Cayman Islands":54.19,"Guam":49.22,"Bahamas":48.18,"New Caledonia":47.71,"Vanuatu":46.89,"United Kingdom":45.18,"Iceland":43.63,"New Zealand":43.14,"Ghana":42.67,"Greenland":42.57,"Denmark":42.27,"Netherlands":41.69,"Ireland":40.45,"Bahrain":40.01,"Kuwait":39.77,"Venezuela":38.58,"France":38.49,"Burundi":38.39,"South Korea":38.37,"Seychelles":37.5,"United States":37.45,"Aruba":36.79,"Japan":36.78,"Azerbaijan":36.29,"Belgium":36.2,"Canada":36.05,"Finland":36.05,"Israel":35.77,"Mozambique":35.62,"Lebanon":35.01,"Sweden":34.35,"Austria":33.54,"Gabon":32.79,"Panama":32.76,"Italy":32.14,"Holy See":32.14,"Brunei Darussalam":31.67,"Germany":31.3,"Reunion":31.22,"Maldives":30.71,"Democratic Republic of the Congo":30.27,"Oman":29.96,"Russian Federation":28.45,"Fiji":27.82,"Tuvalu":27.82,"Mauritius":27.8,"Mongolia":27.7,"French Polynesia":27.58,"Faroe Islands":27.44,"Spain":26.95,"Curacao":26.72,"Samoa":26.15,"Tokelau":26.15,"Wallis and Futuna":26.15,"American Samoa":26.15,"Niue":26.15,"Haiti":25.56,"Rwanda":25.3,"Uruguay":24.98,"Zambia":24.61,"Namibia":24.49,"Barbados":24.46,"China":24.34,"Andorra":24.03,"Slovenia":23.26,"Trinidad and Tobago":23.05,"Cameroon":22.87,"Portugal":22.82,"Slovakia":22.39,"Nigeria":22.1,"Brazil":22.07,"Equatorial Guinea":21.96,"Tanzania":21.94,"Kazakhstan":21.88,"Ethiopia":21.82,"Burma":21.48,"Puerto Rico":21.43,"Djibouti":21.32,"Cyprus":21.14,"Zimbabwe":20.68,"Iran":20.3,"Costa Rica":19.77,"Libya":19.74,"Jamaica":19.74,"Taiwan":19.68,"Kenya":19.64,"Poland":19.23,"Estonia":18.91,"Malta":18.86,"Thailand":18.85,"Iraq":18.67,"Czech Republic":18.43,"South Africa":18.15,"Grenada":17.82,"Chile":17.76,"Somalia":17.6,"Argentina":17.58,"Guyana":17.34,"Belarus":17.16,"Latvia":17.12,"Belize":16.99,"Lao People's Democratic Republic":16.33,"Peru":16.2,"Jordan":15.92,"Guatemala":15.92,"Vietnam":15.86,"Dominica":15.69,"Malaysia":15.66,"Saudi Arabia":15.54,"Lithuania":15.5,"Greece":15.3,"Turkmenistan":15,"Suriname":14.97,"Armenia":14.73,"Colombia":14.72,"Uzbekistan":14.49,"Croatia":14.27,"Ecuador":14.16,"Mali":14.02,"Cambodia":13.94,"Swaziland":13.89,"Bolivia":13.69,"Saint Lucia":13.65,"Ukraine":13.6,"Indonesia":13.56,"Botswana":13.56,"Sudan":13.5,"Turkey":13.12,"Uganda":13.03,"Morocco":12.88,"Romania":12.64,"Kyrgyzstan":12.5,"Syrian Arab Republic":12.39,"Dominican Republic":12.37,"Georgia":12.34,"Mexico":12.24,"Honduras":11.92,"Montenegro":11.82,"Malawi":11.7,"Sri Lanka":11.61,"Madagascar":11.4,"Comoros":11.4,"Mayotte":11.4,"Bulgaria":11.4,"Senegal":11.37,"Serbia":11.2,"Albania":11.2,"Paraguay":10.99,"El Salvador":10.97,"Hungary":10.72,"Tunisia":10.11,"Nicaragua":9.8,"Egypt":9.64,"Moldova (Republic of)":9.6,"Afghanistan":9.58,"Algeria":9.14,"North Macedonia":9,"Philippines":8.9,"Bosnia and Herzegovina":8.57,"Cuba":8.32,"India":7.1,"Bangladesh":7,"Yemen":6.34,"Tajikistan":6.14,"Lesotho":5.19,"Pakistan":4.85,"Nepal":3.38,"Gambia":34.8,"Sierra Leone":46.8,"Guinea":30.0,"South Sudan":48.3,"Åland Islands":35.8,"Turks and Caicos Islands":50.0,"Marshall Islands":27.5,"Nauru":27.5,"Mauritania":20.0,"Western Sahara":20.0,"Saint Pierre and Miquelon":83.0,"Niger":17.0,"Anguilla":38.0,"Benin":25.0,"Antigua and Barbuda":28.2,"Saint Martin (French part)":20.3,"Sint Maarten (Dutch part)":20.3,"Togo":13.5,"Curaçao":32.2,"Martinique":35.5,"Réunion":25.0,"Republic of Kosovo":12.9,"Cabo Verde":16.1,"Montserrat":10.5,"Guinea-Bissau":25.0,
"Palestine":28.9,"Congo":38.7,"Micronesia (Federated States of)":25.0,"Bhutan":11.6,"Burkina Faso":27.4,"Myanmar":30.6,"Tonga":35.5,"Chad":30.0,"Central African Republic":30.0,
"Sao Tome and Principe":7.1,"Saint Vincent and the Grenadines":38.7,"Cook Islands":37.0,"U.S. Virgin Islands":70.0,"Falkland Islands (Malvinas)":25.8,
"Palau":43.0,"Guadeloupe":35.8,"Bonaire, Sint Eustatius and Saba":33.9,"Côte d'Ivoire":32.2,"Saint Kitts and Nevis":19.35,"Solomon Islands":38.7,
"Timor-Leste":35.5,"Liechtenstein":50.0,"French Guiana":32.2,"Kiribati":18.8,"Eritrea":13.3,"San Marino":23.3,"Northern Mariana Islands":18.9}

document.getElementById("median").innerHTML="$"+(housingList[country.name]*31.0).toFixed(2)
/*document.getElementById("medianDiffVal").innerHTML="$"+country.housingDiff.toFixed(2)
var avgIncomeDiffStyle="border: none; color:green;"
document.getElementById("medianDiff").style=avgIncomeDiffStyle
document.getElementById("tooltiptextmedianDiff").innerHTML="Better than average"*/

if(isNaN(country.taxRates)){
  if(isNaN(country.highIncomeTax)){
    document.getElementById("higherIncomeTax").style.display="none"
  }else{
    document.getElementById("higherIncomeTax").innerHTML=country.highIncomeTax+"%"
  }
 if(isNaN(country.lowIncomeTax)){
    document.getElementById("lowerIncomeTax").style.display="none"
  }else{
    document.getElementById("lowerIncomeTax").innerHTML=country.lowIncomeTax+"%"
  }
  if(isNaN(country.salesTax)){
    document.getElementById("salesTax").style.display="none"
  }else{
    document.getElementById("salesTax").innerHTML=country.salesTax+"%"
  }
}else{
  document.getElementById("salesTax").innerHTML=country.taxRates.salesTax+"%"
  document.getElementById("lowerIncomeTax").innerHTML=country.taxRates.lowIncomeTax+"%"
  document.getElementById("higherIncomeTax").innerHTML=country.taxRates.highIncomeTax+"%"
}

document.getElementById("crimeRate").innerHTML=country.crimeRate+"%"
document.getElementById("freedomIndex").innerHTML=parseFloat(country.freedomIndex).toFixed(1)+"/100.0"
if(country.freedomIndex<35.0){
  document.getElementById("freedomIndex").innerHTML=parseFloat(country.freedomIndex).toFixed(1)+"/100.0 (Not free)"
  document.getElementById("freedomIndex").style.color="red"
}else if(country.freedomIndex>68.0)
{
  document.getElementById("freedomIndex").innerHTML=parseFloat(country.freedomIndex).toFixed(1)+"/100.0 (Free)"
  document.getElementById("freedomIndex").style.color="blue"
}else{
  document.getElementById("freedomIndex").innerHTML=parseFloat(country.freedomIndex).toFixed(1)+"/100.0 (Partly free)"
  document.getElementById("freedomIndex").style.color="orange"
}
document.getElementById("hdiValue").innerHTML=parseFloat(country.hdiValue).toFixed(3)+"/1.0"
if(country.freedomIndex<=0.350){ //https://en.wikipedia.org/wiki/List_of_countries_by_Human_Development_Index
  document.getElementById("hdiValue").innerHTML=parseFloat(country.hdiValue).toFixed(3)+"/1.000 (low)"
  document.getElementById("hdiValue").style.color="red"
}else if(country.freedomIndex>=.700)
{
  document.getElementById("hdiValue").innerHTML=parseFloat(country.hdiValue).toFixed(3)+"/1.000 (high)"
  document.getElementById("hdiValue").style.color="blue"
}else{
  document.getElementById("hdiValue").innerHTML=parseFloat(country.hdiValue).toFixed(3)+"/1.000 (medium)"
  document.getElementById("hdiValue").style.color="orange"
}
document.getElementById("ageExp").innerHTML=parseFloat(country.ageExp).toFixed(1)+" years old"

if(country.temp.fTemp==null)
  country.temp.fTemp=(country.temp.cTemp * 9.0 / 5.0) + 32.0
document.getElementById("temp").innerHTML=parseFloat(country.temp.cTemp).toFixed(1)+" degrees celsius, ("+parseFloat(country.temp.fTemp).toFixed(1)+" degrees farenheit)"
document.getElementById("tempDiffVal").innerHTML=Math.abs(parseFloat(country.temp.cTemp)-14.9).toFixed(1)+" degrees celsius, ("+((Math.abs(parseFloat(country.temp.cTemp)-14.9) * 9.0 / 5.0) + 32.0).toFixed(1)+" degrees farenheit)"
var tempDiffStyle="border: none;"
text=""
if(parseFloat(country.temp.cTemp)-14.9>0.0){
  document.getElementById("tempDiffVal").innerHTML=document.getElementById("tempDiffVal").innerHTML+" ABOVE world average"
}else if(parseFloat(country.temp.cTemp)-14.9<0.0){
    document.getElementById("tempDiffVal").innerHTML=document.getElementById("tempDiffVal").innerHTML+" BELOW world average"
}else{
    document.getElementById("tempDiffVal").innerHTML=document.getElementById("tempDiffVal").innerHTML+" (equal to world average)"
}
if(parseFloat(country.temp.cTemp-14.9)>5.0){
  //text="Hotter average temp"
  tempDiffStyle="border: none; color:red;"
}else if(parseFloat(country.temp.cTemp-14.9)<-5.0){
  //text="Colder than average"
  tempDiffStyle="border: none; color:blue;"
}else{
  //text="Around average temp"
  tempDiffStyle="border: none; color:#ff8c00;"
}
document.getElementById("tempDiff").style=tempDiffStyle
document.getElementById("tooltiptexttempDiff").style.display="none"

var config = {
    apiKey: "AIzaSyAeVY1LvG9hNSBYb9_raGpYYDiHIvG3cY8",
    authDomain: "emovousers.firebaseapp.com",
    databaseURL: "https://emovousers.firebaseio.com/",
    storageBucket: "emovousers.appspot.com"
  }
firebase.initializeApp(config);
document.getElementById("profileImg").src="https://cdn2.iconfinder.com/data/icons/website-icons/512/User_Avatar-512.png"//currUser.picture
function Comment(t,d,p,li,di,id,na,sv,ud){
  this.text=t
  this.date=d
  this.place=p
  this.likes=li
  this.dislikes=di
  this.profileID=id
  this.profileName=na
  //this.profilePic=pi
  this.starVal=sv
  this.updownDiff=ud
}
/*function Comment(t,d,p,li,di,id,na,pi,sv,ud){
  this.text=t
  this.date=d
  this.place=p
  this.likes=li
  this.dislikes=di
  this.profileID=id
  this.profileName=na
  this.profilePic=pi
  this.starVal=sv
  this.updownDiff=ud
}
var currUser=isLoggedIn()
if(currUser!=null){
  //currUser=JSON.parse(currUser)
  //currUser["id"] =
  //currUser["name"] =
  //currUser["picture"] =
  //document.getElementById("displayButton").style="display: none;"
  //document.getElementById("login").style="display: none;"
  document.getElementById("profileImg").src=currUser.picture
}
getFirebaseComments()*/
function sendMessage(){
  var d=new Date();
  var starval=-1
  var ptext=document.getElementById("yourComment").value
  try{
    starval=parseInt($("input[name='star']:checked").val())
    //console.log(starval)
    if(isNaN(starval)){
      starval=-1.0
    }
  }catch(err){
    starval=-1.0
  }
  var text=ptext
  //var profile = auth2.currentUser.get().getBasicProfile();
  var array = new Uint32Array(1);
  window.crypto.getRandomValues(array);
  var uid=array[0]
  var profileID="user-"+uid
  var aComment=new Comment(text,d.getTime(),country,0,0,uid,profileID,starval,0)
  firebase.database().ref().child("countries").child(country.name).child("comments").child(uid).set({
    "text":aComment.text,
    "date":aComment.date,
    "place":aComment.place,
    "likes":aComment.likes,
    "dislikes":aComment.dislikes,
    "profileID":aComment.profileID,
    "profileName":aComment.profileName,
    "starVal":aComment.starVal,
    "updownDiff":aComment.updownDiff
  })
  //display comment
  document.getElementById("login").innerHTML="Comment '"+text.slice(0,10)+"...' was added"
    var overall=document.getElementById("justSents")
    //overall.appendChild(document.createElement("br"))
    var urdiv = document.createElement("div")
    urdiv.className="userReply"
    var leftpicDiv=document.createElement("div")
    leftpicDiv.className="left-pic"
    var profileImg=document.createElement("img")
    profileImg.src="https://cdn2.iconfinder.com/data/icons/website-icons/512/User_Avatar-512.png"
    profileImg.style="border-radius:50%;width:70px;height:70px;"
    leftpicDiv.appendChild(profileImg)
    urdiv.appendChild(leftpicDiv)
    var rightDiv=document.createElement("div")
    rightDiv.className="right"
    var commentDiv=document.createElement("div")
    commentDiv.className="comment-body"
    commentDiv.appendChild(document.createTextNode(aComment.text))
    rightDiv.appendChild(commentDiv)
    var bottomDiv=document.createElement("div")
    var bytext="By "
    if(isNaN(aComment.starVal)){}
    else{
     if(aComment.starVal!=null){
      if(aComment.starVal!=-1.0){
        bytext="(Rated "+aComment.starVal+" stars), By "
      }
     }
    }
    //console.log(bytext)
    bottomDiv.appendChild(document.createTextNode(bytext))
    //var n = document.createElement('a');
    var lt = document.createTextNode(profileID);
    //n.appendChild(lt)
    //n.href = "profile.html";
    bottomDiv.appendChild(lt)
    var date = new Date(aComment.date);
    var day = date.getDate();
    var months = ["January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];
    var month = date.getMonth()//months[date.getMonth()];
    var year = date.getFullYear().toString().substr(-2);
    var stDate = month+"/"+day+"/"+year
    bottomDiv.appendChild(document.createTextNode(", "+stDate+", "))
    var score=document.createElement("span")
    score.id="score"
    score.innerHTML=(aComment.likes-aComment.dislikes)+""
    if(aComment.likes-aComment.dislikes==0)
      score.style="color:grey;"
    else if(aComment.likes-aComment.dislikes>0)
      score.style="color:green;"
    else if(aComment.likes-aComment.dislikes<0)
      score.style="color:red;"
    //console.log("complete")
    bottomDiv.appendChild(score)
    rightDiv.appendChild(bottomDiv)
    urdiv.appendChild(rightDiv)
    overall.appendChild(urdiv)
  /*if(currUser!=null){
    var d=new Date();
    var starval=-1
    var ptext=document.getElementById("yourComment").value
    try{
      starval=parseInt($("input[name='star']:checked").val())
      console.log(starval)
      if(isNaN(starval)){
        starval=-1.0
      }
    }catch(err){
      starval=-1.0
    }
    var text=ptext
    var aComment=new Comment(text,d.getTime(),country,0,0,currUser.id,currUser.name,currUser.picture,starval,0)
    //var profile = auth2.currentUser.get().getBasicProfile();
    var array = new Uint32Array(1);
    window.crypto.getRandomValues(array);
    var uid=array[0]
    //var sRef = //send for users to see
      //console.log(snapshotData)
        var sRef2 = firebase.database().ref().child("users").child(currUser["id"])//check if user in database
        sRef2.on("value", function(snapshot2, prevChildKey) {
          var snapshotData2 = snapshot2.val();
          if(snapshotData2==null){ //user not there
            var sRef3 = firebase.database().ref()
            var date = new Date();
            var day = date.getDate();
            var months = ["January", "February", "March", "April", "May", "June",
              "July", "August", "September", "October", "November", "December"
            ];
            var month = months[date.getMonth()];
            var year = date.getFullYear();
            var stDate = month+" "+day+", "+year
            currUser["joinDate"] = stDate;
            //console.log(month);
            sRef3.child("users").child(currUser["id"]).set({
              "id":currUser["id"],
              "name":currUser["name"],
              "picture":currUser["picture"],
              "joinDate":currUser["joinDate"],
              "comments":first
            })
          }else{
            var sRef5 = firebase.database().ref().child("users").child(currUser["id"]).child("comments").child(uid)
            console.log(aComment.starVal)
            sRef5.on("value", function(snapshot, prevChildKey) {//set it to profile
              var snapshotDataC = snapshot.val();
              sRef5.set({aComment})
              firebase.database().ref().child("countries").child(country.name).child("comments").child(uid).set({aComment})
            })
            //console.log(snapshotData2)
          }
        })
    //})
    //firebase.database().ref().child("users").child(currUser.id).child("comments").child(uid).set({aComment})
    firebase.database().ref().child("countries").child(country.name).child("comments").child(uid).set({aComment})
    //display comment
      var overall=document.getElementById("justSents")
      //overall.appendChild(document.createElement("br"))
      var urdiv = document.createElement("div")
      urdiv.className="userReply"
      var leftpicDiv=document.createElement("div")
      leftpicDiv.className="left-pic"
      var profileImg=document.createElement("img")
      profileImg.onclick=function(){
        window.location.href="profile.html"
      }
      profileImg.src=currUser.picture
      profileImg.style="border-radius: 50%;width:70px;height:70px;"
      leftpicDiv.appendChild(profileImg)
      urdiv.appendChild(leftpicDiv)
      var rightDiv=document.createElement("div")
      rightDiv.className="right"
      var commentDiv=document.createElement("div")
      commentDiv.className="comment-body"
      commentDiv.appendChild(document.createTextNode(aComment.text))
      rightDiv.appendChild(commentDiv)
      var bottomDiv=document.createElement("div")
      var bytext="By "
      if(isNaN(aComment.starVal)){}
      else{
       if(aComment.starVal!=null){
        if(aComment.starVal!=-1.0){
          bytext="(Rated "+aComment.starVal+" stars), By "
        }
       }
      }
      //console.log(bytext)
      bottomDiv.appendChild(document.createTextNode(bytext))
      var n = document.createElement('a');
      var lt = document.createTextNode(currUser.name);
      n.appendChild(lt)
      n.href = "profile.html";
      bottomDiv.appendChild(n)
      var date = new Date(aComment.date);
      var day = date.getDate();
      var months = ["January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
      ];
      var month = months[date.getMonth()];
      var year = date.getFullYear();
      var stDate = month+" "+day+", "+year
      bottomDiv.appendChild(document.createTextNode(", "+stDate+", "))
      var score=document.createElement("span")
      score.id="score"
      score.innerHTML=(aComment.likes-aComment.dislikes)+""
      if(aComment.likes-aComment.dislikes==0)
        score.style="color:grey;"
      else if(aComment.likes-aComment.dislikes>0)
        score.style="color:green;"
      else if(aComment.likes-aComment.dislikes<0)
        score.style="color:orange;"
      bottomDiv.appendChild(score)
      rightDiv.appendChild(bottomDiv)
      urdiv.appendChild(rightDiv)
      overall.appendChild(urdiv)
      //document.getElementById("login").style="display:table; margin:0 auto"
      //document.getElementById("login").innerHTML="Comment '"+text.slice(0,10)+"...' was added"
  }else{
    //document.getElementById("login").style="display:table; margin:0 auto"
    return;
  }*/
}
var getData=null
var deleteclicks={}
var editclicks={}
var updownvotes={}
//document.getElementById("input").style.display="none"
document.getElementById("commentFilter").style.display="none"
getFirebaseComments()
function getFirebaseComments(){
  var totalStars=0.0
  var starRatingCount=0.0
  var ref=firebase.database().ref().child("countries").child(country.name).child("comments")
  ref.on("value", function(snapshot, prevChildKey) {//set it to profile
    var snapshotData = snapshot.val();
    //console.log(snapshotData)
    if(snapshotData!=null){
      getData=snapshotData
      var commentCount=0
      for(var i in snapshotData){
        var overall=document.getElementById("commentSpace")
        if(i<=9){
          overall.appendChild(document.createElement("br"))
        }
        if(snapshotData[i].starVal!=-1.0){
          totalStars+=parseFloat(snapshotData[i].starVal)
          starRatingCount+=1.0
        }
        updownvotes[i]=0
        var urdiv = document.createElement("div")
        urdiv.id=i+"-comment"
        urdiv.className="userReply"
        var leftpicDiv=document.createElement("div")
        leftpicDiv.className="left-pic"
        var profileImg=document.createElement("img")
        profileImg.id=snapshotData[i].profileID+"-"+i
        profileImg.src="https://cdn2.iconfinder.com/data/icons/website-icons/512/User_Avatar-512.png"
        profileImg.style="border-radius: 50%;width:50px;height:50px;"
        leftpicDiv.appendChild(profileImg)
        urdiv.appendChild(leftpicDiv)
        var rightDiv=document.createElement("div")
        rightDiv.className="right"
        var commentDiv=document.createElement("div")
        commentDiv.id=snapshotData[i].profileID+"-commentDiv"
        commentDiv.className="comment-body"
        commentDiv.appendChild(document.createTextNode(snapshotData[i].text))
        rightDiv.appendChild(commentDiv)
        var bottomDiv=document.createElement("div")
        var bytext="By "
        if(isNaN(snapshotData[i].starVal)){}
        else{
         if(snapshotData[i].starVal!=null){
          if(snapshotData[i].starVal!=-1.0){
            bytext="("+snapshotData[i].starVal+" stars), By "
          }
         }
        }
        //console.log(bytext)
        bottomDiv.appendChild(document.createTextNode(bytext))
        var lt = document.createTextNode(snapshotData[i].profileName);
        bottomDiv.appendChild(lt)
        var date = new Date(snapshotData[i].date);
        var day = date.getDate();
        var months = ["January", "February", "March", "April", "May", "June",
          "July", "August", "September", "October", "November", "December"
        ];
        var month = date.getMonth()//months[date.getMonth()];
        var year = date.getFullYear().toString().substr(-2);
        var stDate = month+"/"+day+"/"+year
        var datediv=document.createTextNode(", "+stDate+", ")
        datediv.id=i+"-dateDiv"
        bottomDiv.appendChild(datediv) //bottomDiv
        var score=document.createElement("span")
        score.id=i+"-score"
        score.innerHTML=(snapshotData[i].likes-snapshotData[i].dislikes)+""
        if(snapshotData[i].likes-snapshotData[i].dislikes==0)
          score.style="color:grey;"
        else if(snapshotData[i].likes-snapshotData[i].dislikes>0)
          score.style="color:green;"
        else if(snapshotData[i].likes-snapshotData[i].dislikes<0)
          score.style="color:red;"
        bottomDiv.appendChild(score)
        bottomDiv.appendChild(document.createTextNode(", "))
        //check if if(currUser["jd"]) exists
        var reply=document.createElement("button")
        reply.id=i+"-reply"
        var ricon=document.createElement("i")
        ricon.className="fa fa-reply"
        reply.appendChild(ricon)
        reply.style="w3-button"
        reply.onclick=function(){
          var rid=this.id.split("-")
          //console.log(getData[rid[0]])
          if(getData[rid[0]].text.length<=50)
            document.getElementById("yourComment").value="Reply to "+getData[parseInt(rid[0])].profileName+"'s comment '"+getData[parseInt(rid[0])].text+"':"
          else
            document.getElementById("yourComment").value="Reply to "+getData[parseInt(rid[0])].profileName+"'s comment '"+getData[parseInt(rid[0])].text.slice(0,50)+"...':"
        }
        var upvote=document.createElement("button")
        upvote.id=i+"-upvote"
        var uicon=document.createElement("i")
        uicon.className="fa fa-thumbs-up"
        upvote.appendChild(uicon)
        upvote.onclick=function(){
          var pid=this.id.split("-")
          updownvotes[parseInt(pid[0])]=1
          getData[parseInt(pid[0])].likes+=1
          var diff=getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes
          if(diff>=2){
            this.style.background="#CDCDCD"
            getData[parseInt(pid[0])].likes-=diff
          }else if(diff==1){
            this.style.background="#99badd"
          }else if(diff==0){
            this.style.background="#99badd"
            getData[parseInt(pid[0])].likes+=1
            document.getElementById(pid[0]+"-downvote").style.background="#CDCDCD"
          }
          var gscore=pid[0]+"-score"
          getData[parseInt(pid[0])].updownDiff=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)
          document.getElementById(gscore).innerHTML=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)+""
          if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes==0)
            document.getElementById(gscore).style="color:grey;"
          else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes>0)
            document.getElementById(gscore).style="color:green;"
          else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes<0)
            document.getElementById(gscore).style="color:red;"
          leave()
        }
        bottomDiv.appendChild(upvote)
        var downvote=document.createElement("button")
        downvote.id=i+"-downvote"
        var dicon=document.createElement("i")
        dicon.className="fa fa-thumbs-down"
        downvote.appendChild(dicon)
        downvote.style="w3-button"
        downvote.onclick=function(){
          var pid=this.id.split("-")
          updownvotes[parseInt(pid[0])]=-1
          getData[parseInt(pid[0])].dislikes+=1
          var diff=getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes
          if(diff<=-2){
            this.style.background="#CDCDCD"
            getData[parseInt(pid[0])].dislikes+=diff
          }else if(diff==-1){
            this.style.background="#ED4337"
          }else if(diff==0){
            this.style.background="#ED4337"
            getData[parseInt(pid[0])].dislikes+=1
            document.getElementById(pid[0]+"-upvote").style.background="#CDCDCD"
          }
          var gscore=pid[0]+"-score"
          getData[parseInt(pid[0])].updownDiff=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)
          document.getElementById(gscore).innerHTML=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)+""
          if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes==0)
            document.getElementById(gscore).style="color:grey;"
          else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes>0)
            document.getElementById(gscore).style="color:green;"
          else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes<0)
            document.getElementById(gscore).style="color:red;"
          leave()
        }
        bottomDiv.appendChild(downvote)
        bottomDiv.appendChild(reply)
        rightDiv.appendChild(bottomDiv)
        urdiv.appendChild(rightDiv)
        if(commentCount>9){
          urdiv.style="display:none;"
        }
        commentCount++
        overall.appendChild(urdiv)
        //document.getElementById("input").style.display="block"
        document.getElementById("commentFilter").style.display="block"
        /*if(currUser!=null)
        {
          reply.onclick=function(){
            var rid=this.id.split("-")
            if(getData[parseInt(rid[0])].text.length<=50)
              document.getElementById("yourComment").value="Reply to: "+getData[parseInt(rid[0])].profileName+"'s comment '"+getData[parseInt(rid[0])].text+"'"
            else
              document.getElementById("yourComment").value="Reply to: "+getData[parseInt(rid[0])].profileName+"'s comment '"+getData[parseInt(rid[0])].text.slice(0,50)+"...'"
          }
          if(currUser.id==snapshotData[i].profileID){
            var upvote=document.createElement("button")
            upvote.id=i+"-upvote"
            var uicon=document.createElement("i")
            uicon.className="fa fa-thumbs-up"
            upvote.appendChild(uicon)
            upvote.onclick=function(){
              var pid=this.id.split("-")
              updownvotes[parseInt(pid[0])]=1
              getData[parseInt(pid[0])].likes+=1
              var diff=getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes
              if(diff>=2){
                this.style.background="#CDCDCD"
                getData[parseInt(pid[0])].likes-=diff
              }else if(diff==1){
                this.style.background="#99badd"
              }else if(diff==0){
                this.style.background="#99badd"
                getData[parseInt(pid[0])].likes+=1
                document.getElementById(pid[0]+"-downvote").style.background="#CDCDCD"
              }
              var gscore=pid[0]+"-score"
              getData[parseInt(pid[0])].updownDiff=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)
              document.getElementById(gscore).innerHTML=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)+""
              if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes==0)
                document.getElementById(gscore).style="color:grey;"
              else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes>0)
                document.getElementById(gscore).style="color:green;"
              else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes<0)
                document.getElementById(gscore).style="color:orange;"
            }
            bottomDiv.appendChild(upvote)
            var downvote=document.createElement("button")
            downvote.id=i+"-downvote"
            var dicon=document.createElement("i")
            dicon.className="fa fa-thumbs-down"
            downvote.appendChild(dicon)
            downvote.style="w3-button"
            downvote.onclick=function(){
              var pid=this.id.split("-")
              updownvotes[parseInt(pid[0])]=-1
              getData[parseInt(pid[0])].dislikes+=1
              var diff=getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes
              if(diff<=-2){
                this.style.background="#CDCDCD"
                getData[parseInt(pid[0])].dislikes+=diff
              }else if(diff==-1){
                this.style.background="#ED4337"
              }else if(diff==0){
                this.style.background="#ED4337"
                getData[parseInt(pid[0])].dislikes+=1
                document.getElementById(pid[0]+"-upvote").style.background="#CDCDCD"
              }
              var gscore=pid[0]+"-score"
              getData[parseInt(pid[0])].updownDiff=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)
              document.getElementById(gscore).innerHTML=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)+""
              if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes==0)
                document.getElementById(gscore).style="color:grey;"
              else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes>0)
                document.getElementById(gscore).style="color:green;"
              else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes<0)
                document.getElementById(gscore).style="color:orange;"
            }
            bottomDiv.appendChild(downvote)
            var edit=document.createElement("button")
            edit.id=snapshotData[i].profileID+"-edit"
            var eicon=document.createElement("i")
            eicon.className="fa fa-pencil"
            edit.appendChild(eicon)
            edit.onclick=function(){
              var eid=this.id.split("-")
              editclicks[eid[0]]+=1
              if(editclicks[eid[0]]%2==1){
                this.style.background="#FFFFD5"
                document.getElementById(eid+"-comment").style.display="none"
                document.getElementById("yourComment").value=getData[parseInt(pid[0])].text
              }else{
                document.getElementById(eid+"-comment").style.display="block"
                this.style.background="#CDCDCD"
              }
            }
            bottomDiv.appendChild(edit)
            var trash=document.createElement("button")
            trash.id=snapshotData[i].profileID+"-trash"
            var ticon=document.createElement("i")
            ticon.className="fa fa-trash-o"
            trash.appendChild(ticon)
            deleteclicks[i]=0
            editclicks[i]=0
            trash.onclick=function(){
              var tid=this.id.split("-")
              deleteclicks[tid[0]]+=1
              if(deleteclicks[tid[0]]%2==1){
                this.style.background="#90EE90"
              }else{
                this.style.background="#CDCDCD"
              }
            }
            trash.style="w3-button"
            bottomDiv.appendChild(trash)
          }
          bottomDiv.appendChild(reply)
        }*/


        //document.body.appendChild(document.createElement("br"))
      }
    }
    if(starRatingCount==0){
      document.getElementById("avgStar").innerHTML=country.name+" has 0 reviews. Be the first!"
    }else{
      if(starRatingCount==1)
        document.getElementById("avgStar").innerHTML="Average location rating of "+(totalStars/starRatingCount).toFixed(3)+" stars with "+starRatingCount+" review."
      else
        document.getElementById("avgStar").innerHTML="Average location rating of "+(totalStars/starRatingCount).toFixed(3)+" stars with "+starRatingCount+" reviews."
    }
  })
}
function leave(){
  //check getData
  var ref=firebase.database().ref().child("countries").child(country.name).child("comments")
  ref.on("value", function(snapshot, prevChildKey) {//set it to profile
    var snapshotData = snapshot.val();
    //console.log(snapshotData)
    if(snapshotData!=null){
      for(var i in snapshotData){
        comment=snapshotData[i]
        /*if(editclicks[i]%2==1){
          ref.child(i).set(null) //delete old comment
        }*/
        if(deleteclicks[i]%2==1){
          ref.child(i).set(null) //delete this comment
        }
        if(updownvotes[i]==1){
          comment.likes+=1
        }else if(updownvotes[i]==-1){
          comment.likes-=1
        }
        ref.child(i).set(comment)
      }
    }
  })
}
function onCitySearchClick(){ //begin a city search, grab city list here and pass it
  //leave()
  localStorage.setItem('currNation',JSON.stringify(country)) //make it a country object
  location.href="loadingWorldCities.html"
}
$(window).scroll(function() {
  if($(window).scrollTop() == $(document).height() - $(window).height()) {
    withModal=$("div:hidden").slice(0, 10).fadeIn()
  }
});
/*function isLoggedIn()
{
  if(localStorage.getItem('currUser') == null){
    return null;
  } else {
    return JSON.parse(localStorage.getItem('currUser'));
  }
}

function getComments(snapshotData2){
  var totalStars=0.0
  var starRatingCount=0.0
  var commentCount=0
  for(var i in snapshotData2){
    var snapshotData=snapshotData2[i][1]
    var overall=document.getElementById("updownSort")
    if(i<=9){
      overall.appendChild(document.createElement("br"))
    }
    if(isNaN(snapshotData.aComment.starVal)){
      totalStars+=0.0
      starRatingCount+=0.0
    }
    else if(snapshotData.aComment.starVal!=-1.0){
      totalStars+=parseFloat(snapshotData.aComment.starVal)
      starRatingCount+=1.0
    }
    updownvotes[i]=0
    var urdiv = document.createElement("div")
    urdiv.id=i+"-comment"
    urdiv.className="userReply"
    var leftpicDiv=document.createElement("div")
    leftpicDiv.className="left-pic"
    var profileImg=document.createElement("img")
    profileImg.src=snapshotData.aComment.profilePic
    profileImg.style="border-radius: 50%;width:70px;height:70px;"
    leftpicDiv.appendChild(profileImg)
    urdiv.appendChild(leftpicDiv)
    var rightDiv=document.createElement("div")
    rightDiv.className="right"
    var commentDiv=document.createElement("div")
    commentDiv.className="comment-body"
    commentDiv.appendChild(document.createTextNode(snapshotData.aComment.text))
    rightDiv.appendChild(commentDiv)
    var bottomDiv=document.createElement("div")
    bottomDiv.appendChild(document.createTextNode("By "))
    var lt = document.createTextNode(snapshotData.aComment.profileName);
    bottomDiv.appendChild(lt)
    var date = new Date(snapshotData.aComment.date);
    var day = date.getDate();
    var months = ["January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];
    var month = months[date.getMonth()];
    var year = date.getFullYear();
    var stDate = month+" "+day+", "+year
    bottomDiv.appendChild(document.createTextNode(", "+stDate+", ")) //bottomDiv
    var score=document.createElement("span")
    score.id=i+"-score"
    score.innerHTML=(snapshotData.aComment.likes-snapshotData.aComment.dislikes)+""
    if(snapshotData.aComment.likes-snapshotData.aComment.dislikes==0)
      score.style="color:grey;"
    else if(snapshotData.aComment.likes-snapshotData.aComment.dislikes>0)
      score.style="color:green;"
    else if(snapshotData.aComment.likes-snapshotData.aComment.dislikes<0)
      score.style="color:orange;"
    bottomDiv.appendChild(score)
    bottomDiv.appendChild(document.createTextNode(", "))
    var upvote=document.createElement("button")
    upvote.id=i+"-upvote"
    var uicon=document.createElement("i")
    uicon.className="fa fa-thumbs-up"
    upvote.appendChild(uicon)
    upvote.onclick=function(){
      var pid=this.id.split("-")
      updownvotes[parseInt(pid[0])]=1
      getData[parseInt(pid[0])].aComment.likes+=1
      var diff=getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes
      if(diff>=2){
        this.style.background="#CDCDCD"
        getData[parseInt(pid[0])].aComment.likes-=diff
      }else if(diff==1){
        this.style.background="#99badd"
      }else if(diff==0){
        this.style.background="#99badd"
        getData[parseInt(pid[0])].aComment.likes+=1
        document.getElementById(pid[0]+"-downvote").style.background="#CDCDCD"
      }
      var gscore=pid[0]+"-score"
      getData[parseInt(pid[0])].updownDiff=(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes)
      document.getElementById(gscore).innerHTML=(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes)+""
      if(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes==0)
        document.getElementById(gscore).style="color:grey;"
      else if(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes>0)
        document.getElementById(gscore).style="color:green;"
      else if(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes<0)
        document.getElementById(gscore).style="color:orange;"
    }
    bottomDiv.appendChild(upvote)
    var downvote=document.createElement("button")
    downvote.id=i+"-downvote"
    var dicon=document.createElement("i")
    dicon.className="fa fa-thumbs-down"
    downvote.appendChild(dicon)
    downvote.style="w3-button"
    downvote.onclick=function(){
      var pid=this.id.split("-")
      updownvotes[parseInt(pid[0])]=-1
      getData[parseInt(pid[0])].aComment.dislikes+=1
      var diff=getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes
      if(diff<=-2){
        this.style.background="#CDCDCD"
        getData[parseInt(pid[0])].aComment.dislikes+=diff
      }else if(diff==-1){
        this.style.background="#ED4337"
      }else if(diff==0){
        this.style.background="#ED4337"
        getData[parseInt(pid[0])].aComment.dislikes+=1
        document.getElementById(pid[0]+"-upvote").style.background="#CDCDCD"
      }
      var gscore=pid[0]+"-score"
      getData[parseInt(pid[0])].updownDiff=(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes)
      document.getElementById(gscore).innerHTML=(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes)+""
      if(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes==0)
        document.getElementById(gscore).style="color:grey;"
      else if(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes>0)
        document.getElementById(gscore).style="color:green;"
      else if(getData[parseInt(pid[0])].aComment.likes-getData[parseInt(pid[0])].aComment.dislikes<0)
        document.getElementById(gscore).style="color:orange;"
    }
    bottomDiv.appendChild(downvote)
    //check if if(currUser["jd"]) exists
    var reply=document.createElement("button")
    reply.id=i+"-reply"
    var ricon=document.createElement("i")
    ricon.className="fa fa-reply"
    reply.appendChild(ricon)
    reply.style="w3-button"
    if(currUser==null)//  make IT NOT
    {
      reply.onclick=function(){
        var rid=this.id.split("-")
        if(getData[parseInt(rid[0])].aComment.text.length<=50)
          document.getElementById("yourComment").value="Reply to: "+getData[parseInt(rid[0])].aComment.profileName+"'s comment '"+getData[parseInt(rid[0])].aComment.text+"'"
        else
          document.getElementById("yourComment").value="Reply to: "+getData[parseInt(rid[0])].aComment.profileName+"'s comment '"+getData[parseInt(rid[0])].aComment.text.slice(0,50)+"...'"
      }
      if(currUser.id==snapshotData.aComment.profileID){
        var edit=document.createElement("button")
        edit.id=snapshotData.aComment.profileID+"-edit"
        var eicon=document.createElement("i")
        eicon.className="fa fa-pencil"
        edit.appendChild(eicon)
        edit.onclick=function(){
          var eid=this.id.split("-")
          editclicks[eid[0]]+=1
          if(editclicks[eid[0]]%2==1){
            this.style.background="#FFFFD5"
            document.getElementById(eid+"-comment").style.display="none"
            document.getElementById("yourComment").value=getData[parseInt(pid[0])].aComment.text
          }else{
            document.getElementById(eid+"-comment").style.display="block"
            this.style.background="#CDCDCD"
          }
        }
        bottomDiv.appendChild(edit)
        var trash=document.createElement("button")
        trash.id=snapshotData.aComment.profileID+"-trash"
        var ticon=document.createElement("i")
        ticon.className="fa fa-trash-o"
        trash.appendChild(ticon)
        deleteclicks[snapshotData2[i]]=0
        editclicks[snapshotData2[i]]=0
        trash.onclick=function(){
          var tid=this.id.split("-")
          deleteclicks[tid[0]]+=1
          if(deleteclicks[tid[0]]%2==1){
            this.style.background="#90EE90"
          }else{
            this.style.background="#CDCDCD"
          }
        }
        trash.style="w3-button"
        bottomDiv.appendChild(trash)
      }
    }
    bottomDiv.appendChild(reply)
    rightDiv.appendChild(bottomDiv)
    urdiv.appendChild(rightDiv)
    if(commentCount>9){
      urdiv.style="display:none;"
    }
    commentCount++
    overall.appendChild(urdiv)
    //document.body.appendChild(document.createElement("br"))
  }
}*/
function filter() {
  var input = document.getElementById("input");
  var fil = input.value.toUpperCase();
  var choice=document.getElementById("commentFilter").value
  /*if(choice=="keywords"){
    document.getElementById("input").style.display="block"
    document.getElementById("updownSort").style.display="none"
    var commentSpace = document.getElementById("commentSpace");
    var coms = commentSpace.getElementsByClassName("comment-body");
    var fil = input.value;
    //console.log(fil)
    //console.log(coms)
    for (i = 0; i < coms.length; i++) {
        var theid=coms[i].id.split("-")
        txtValue = getData[parseInt(theid)].text
        //console.log(txtValue)
        if (txtValue.indexOf(fil) > -1) {
            coms[i].style.display = "";
        } else {
            //commentDiv.id=snapshotData[i].profileID+"-commentDiv"
            //urdiv.id=i+"-comment"
            var urcommentid=theid[0]+"-comment"
            document.getElementById(urcommentid).style.display="none";
        }
    }
  }*/
  if(choice=="likes"){
    document.getElementById("input").style.display="none"
    var commentSpace = document.getElementById("commentSpace");
    var coms = commentSpace.getElementsByTagName("span");
    var scoresDict={}
    //console.log(coms)
    for (i = 0; i < coms.length; i++) {
      var theid=coms[i].id.split("-")
      var gscoreid=theid[0]+"-score"
      var val=parseInt(document.getElementById(gscoreid).innerHTML)
      var date = new Date(parseInt(getData[theid[0]]["date"]));
      var day = date.getDate();
      var months = ["January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
      ];
      var month = date.getMonth()//months[date.getMonth()];
      var year = date.getFullYear().toString().substr(-2);
      var stDate = month+"/"+day+"/"+year
      var dateadd=", "+stDate+", "
      var key=theid[0]+"-"+dateadd
      scoresDict[key]=val
    }
    var orderedScores = Object.keys(scoresDict).map(function(key) {
      return [key, scoresDict[key]];
    });
    orderedScores.sort(function(first, second) {
      return second[1] - first[1];
    });
    var commentCount=0
    //console.log(orderedScores)
    for(var ky in Object.keys(orderedScores)){
      var overall=document.getElementById("updownSort")
      if(i<=9){
        overall.appendChild(document.createElement("br"))
      }
      var parse=Object.keys(orderedScores)[ky].split("-")
      var likedislikeval=orderedScores[ky]//like-dislike
      var i=parse[0]//id
      var dateval=parse[1]//date
      var pretextid=i+"-commentDiv" //text
      var precommentid=i+"-comment"
      console.log(precommentid)
      console.log(document.getElementById(precommentid))
      var text=getData[i]["text"]
      document.getElementById(precommentid).style.display="none"
      updownvotes[i]=0
      var urdiv = document.createElement("div")
      urdiv.id=i+"-comment"
      urdiv.className="userReply"
      var leftpicDiv=document.createElement("div")
      leftpicDiv.className="left-pic"
      var profileImg=document.createElement("img")
      //profileImg.id=snapshotData[i].profileID+"-"+i
      profileImg.src="https://cdn2.iconfinder.com/data/icons/website-icons/512/User_Avatar-512.png"
      profileImg.style="border-radius: 50%;width:50px;height:50px;"
      leftpicDiv.appendChild(profileImg)
      urdiv.appendChild(leftpicDiv)
      var rightDiv=document.createElement("div")
      rightDiv.className="right"
      var commentDiv=document.createElement("div")
      commentDiv.id=i+"-commentDiv"
      commentDiv.className="comment-body"
      commentDiv.appendChild(document.createTextNode(text))
      rightDiv.appendChild(commentDiv)
      var bottomDiv=document.createElement("div")
      bottomDiv.appendChild(document.createTextNode("By "))
      var pname="user-"+i
      var lt = document.createTextNode(pname);
      bottomDiv.appendChild(lt)
      var datediv=document.createTextNode(dateval)
      datediv.id=i+"-dateDiv"
      bottomDiv.appendChild(datediv) //bottomDiv
      var score=document.createElement("span")
      score.id=i+"-score"
      score.innerHTML=likedislikeval+""
      if(parseInt(likedislikeval)==0)
        score.style="color:grey;"
      else if(parseInt(likedislikeval)>0)
        score.style="color:green;"
      else if(parseInt(likedislikeval)<0)
        score.style="color:red;"
      bottomDiv.appendChild(score)
      bottomDiv.appendChild(document.createTextNode(", "))
      //check if if(currUser["jd"]) exists
      var reply=document.createElement("button")
      reply.id=i+"-reply"
      var ricon=document.createElement("i")
      ricon.className="fa fa-reply"
      reply.appendChild(ricon)
      reply.style="w3-button"
      reply.onclick=function(){
        var rid=this.id.split("-")
        //console.log(getData[rid[0]])
        if(getData[rid[0]].text.length<=50)
          document.getElementById("yourComment").value="Reply to "+getData[parseInt(rid[0])].profileName+"'s comment '"+getData[parseInt(rid[0])].text+"':"
        else
          document.getElementById("yourComment").value="Reply to "+getData[parseInt(rid[0])].profileName+"'s comment '"+getData[parseInt(rid[0])].text.slice(0,50)+"...':"
      }
      var upvote=document.createElement("button")
      upvote.id=i+"-upvote"
      var uicon=document.createElement("i")
      uicon.className="fa fa-thumbs-up"
      upvote.appendChild(uicon)
      upvote.onclick=function(){
        var pid=this.id.split("-")
        updownvotes[parseInt(pid[0])]=1
        getData[parseInt(pid[0])].likes+=1
        var diff=getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes
        if(diff>=2){
          this.style.background="#CDCDCD"
          getData[parseInt(pid[0])].likes-=diff
        }else if(diff==1){
          this.style.background="#99badd"
        }else if(diff==0){
          this.style.background="#99badd"
          getData[parseInt(pid[0])].likes+=1
          document.getElementById(pid[0]+"-downvote").style.background="#CDCDCD"
        }
        var gscore=pid[0]+"-score"
        getData[parseInt(pid[0])].updownDiff=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)
        document.getElementById(gscore).innerHTML=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)+""
        if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes==0)
          document.getElementById(gscore).style="color:grey;"
        else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes>0)
          document.getElementById(gscore).style="color:green;"
        else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes<0)
          document.getElementById(gscore).style="color:red;"
        leave()
      }
      bottomDiv.appendChild(upvote)
      var downvote=document.createElement("button")
      downvote.id=i+"-downvote"
      var dicon=document.createElement("i")
      dicon.className="fa fa-thumbs-down"
      downvote.appendChild(dicon)
      downvote.style="w3-button"
      downvote.onclick=function(){
        var pid=this.id.split("-")
        updownvotes[parseInt(pid[0])]=-1
        getData[parseInt(pid[0])].dislikes+=1
        var diff=getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes
        if(diff<=-2){
          this.style.background="#CDCDCD"
          getData[parseInt(pid[0])].dislikes+=diff
        }else if(diff==-1){
          this.style.background="#ED4337"
        }else if(diff==0){
          this.style.background="#ED4337"
          getData[parseInt(pid[0])].dislikes+=1
          document.getElementById(pid[0]+"-upvote").style.background="#CDCDCD"
        }
        var gscore=pid[0]+"-score"
        getData[parseInt(pid[0])].updownDiff=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)
        document.getElementById(gscore).innerHTML=(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes)+""
        if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes==0)
          document.getElementById(gscore).style="color:grey;"
        else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes>0)
          document.getElementById(gscore).style="color:green;"
        else if(getData[parseInt(pid[0])].likes-getData[parseInt(pid[0])].dislikes<0)
          document.getElementById(gscore).style="color:red;"
        leave()
      }
      bottomDiv.appendChild(downvote)
      bottomDiv.appendChild(reply)
      rightDiv.appendChild(bottomDiv)
      urdiv.appendChild(rightDiv)
      if(commentCount>9){
        urdiv.style="display:none;"
      }
      commentCount++
      overall.appendChild(urdiv)
    }
    document.getElementById("commentSpace").style.display="none"
  }
  /*else if(choice=="replies"){
    var commentSpace = document.getElementById("commentSpace");
    var coms = commentSpace.getElementsByClassName("comment-body");
    var pfil="Reply to: "+currUser.name+"'s"
    var fil=pfil.toUpperCase()
    //console.log(coms)
    for (i = 0; i < coms.length; i++) {
        txtValue = coms[i].innerHTML
        //console.log(txtValue)
        if (txtValue.toUpperCase().indexOf(fil) > -1) {
            coms[i].style.display = "";
        } else {
            coms[i].style.display = "none";
        }
    }
  }*/
}
</script>
</html>
